@model ATMWebApp.Models.CombinedViewModelForDashboard
@{
    Layout = "~/Views/Shared/_DashboardLayout.cshtml";
    ViewData["Title"] = "AdminDashboard";
    ViewData["Navbar-Dashboard"] = "AdminDashboard";
}


@if (ViewBag.User != null)
{
    var index = 1;
    var userData = ViewBag.User;
    ViewData["AccountName"] = userData.User.UserName;
    <h1 id="displayAdminName">Hello @userData.User.UserName</h1>
    <div class="container text-center">
        <div class="row">
            <div class="col text-start">
                <button type="button" class="btn btn-primary" id="addUserButton" data-bs-toggle="modal" data-bs-target="#addUserModal">+ Add user</button>
            </div>
            <div class="col text-end">
                <form class="d-flex" asp-action="AdminDashboard" method="post" asp-controller="Dashboard">
                    <input class="form-control me-2" id="searchingUser" type="search" placeholder="Search by Customer name or Account Number" aria-label="Search" name="searchValue">
                    <button class="btn btn-outline-primary" id="submitSearchButton" type="submit" value="AdminDashboard">Search</button>
                </form>
            </div>

            <!-- Modal -->
            <div class="modal fade" id="addUserModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="addUserModalTitle">Add User</h5>
                            <button type="button" class="close border-1" data-bs-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body container-fluid w-100">
                            @Html.Partial("_addUserPartialView", Model)
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <table class="table table-striped mt-2">
            <thead>
                <tr>
                    <th scope="col">S.N.</th>
                    <th scope="col">Customer Name</th>
                    <th scope="col">Account Number</th>
                    <th scope="col">Customer Balance</th>
                    <th scope="col">Account Stauts</th>
                    <th scope="col">Edit User</th>
                </tr>
            </thead>
            <tbody>
                @if (userData.Users.Count != 0)
                {
                    @foreach (var Customer in userData.Users)
                    {

                        var deleteUrl = Url.Action("DeleteUser", "Dashboard", new { accountNumber = Customer.AccountNumber });
                        <tr>
                            <th scope="row">@index</th>
                            <td>@Customer.UserName</td>
                            <td>@Customer.AccountNumber</td>
                            <td>@Customer.Balance</td>
                            <td>@Customer.AccountStatus</td>
                            <td> @Html.ActionLink("Edit User Detail", "EditUserView", "Dashboard", new { accountNumber = Customer.AccountNumber }, null) | <a href="#" onclick="confirmDelete('@deleteUrl')">Delete User</a> </td>
                        </tr>
                        index++;
                    }
                }
                else
                {
                    <tr>
                        <td colspan="7">No User Found</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
}

<scripts>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="~/js/adminDashboardDeleteUser.js"></script>
    <script src="~/js/adminDashboardAddUserValidation.js"></script>
</scripts>


